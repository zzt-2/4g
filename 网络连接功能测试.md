# 网络连接功能测试

## 测试目标

验证新实现的网络连接功能是否正常工作，包括：

- 网络Store初始化
- 统一发送路由器
- 连接目标管理
- 数据监听机制

## 测试环境

- 应用：RS485上位机
- 架构：Vue 3 + TypeScript + Quasar + Electron
- 测试范围：网络连接基础功能

## 功能测试清单

### 1. 网络Store初始化测试

**测试步骤：**

1. 启动应用
2. 检查控制台输出
3. 验证网络Store是否正确初始化

**预期结果：**

- 控制台显示"网络Store初始化完成"
- 无初始化错误

### 2. 统一发送路由器测试

**测试步骤：**

```javascript
// 在浏览器控制台执行
import { useUnifiedSender } from './src/composables/frames/sendFrame/useUnifiedSender';

const sender = useUnifiedSender();
console.log('统一发送器方法:', Object.keys(sender));
```

**预期结果：**

- 返回包含sendFrameInstance等方法的对象
- 方法可正常调用

### 3. 连接目标管理测试

**测试步骤：**

```javascript
// 在浏览器控制台执行
import { useConnectionTargets } from './src/composables/useConnectionTargets';

const targets = useConnectionTargets();
console.log('可用目标:', targets.availableTargets.value);
console.log('按类型分组:', targets.targetsByType.value);
```

**预期结果：**

- 能正确获取串口和网络连接目标
- 目标按类型正确分组

### 4. 网络连接创建测试

**测试步骤：**

```javascript
// 模拟网络连接配置
const config = {
  id: 'test-tcp-connection',
  type: 'tcp',
  host: '127.0.0.1',
  port: 8080,
  name: '测试TCP连接',
};

// 尝试连接（需要有对应的服务端）
networkStore.connect(config);
```

**预期结果：**

- 连接请求正确发送到主进程
- 返回适当的连接结果

## 集成测试

### 发送任务执行器测试

**测试场景：**

1. 创建包含网络目标的发送任务
2. 执行任务
3. 验证统一发送路由器是否正确路由

**验证点：**

- 任务能正确识别网络目标
- 发送请求路由到网络API
- 错误处理正确

## 错误处理测试

### 连接失败处理

**测试步骤：**

1. 尝试连接不存在的网络地址
2. 观察错误处理

**预期结果：**

- 返回明确的错误信息
- 不影响其他功能

### 发送失败处理

**测试步骤：**

1. 向断开的网络连接发送数据
2. 观察错误处理

**预期结果：**

- 正确检测连接状态
- 任务状态更新为暂停

## 性能测试

### 内存泄漏检测

**测试步骤：**

1. 创建多个网络连接
2. 断开连接
3. 检查监听器是否正确清理

**验证点：**

- 监听器正确移除
- 无内存泄漏

## 测试结果

### 基础功能测试

- [ ] 网络Store初始化
- [ ] 统一发送路由器
- [ ] 连接目标管理
- [ ] 网络连接创建

### 集成测试

- [ ] 发送任务执行器
- [ ] 数据监听机制

### 错误处理测试

- [ ] 连接失败处理
- [ ] 发送失败处理

### 性能测试

- [ ] 内存泄漏检测

## 问题记录

### 发现的问题

1. **问题描述：**

   - **解决方案：**

   -

2. **问题描述：**

   - **解决方案：**

   -

## 测试总结

**整体评估：**

- 功能完整性：
- 稳定性：
- 性能表现：

**建议改进：**

- **测试结论：**

- [ ] 通过，可以发布
- [ ] 需要修复问题后重测
- [ ] 需要重大修改
